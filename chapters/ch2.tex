\chapter{Requisiti Funzionali}

\renewcommand{\thesubsection}{\textbf{RF\arabic{section}.\arabic{subsection}}}

\setlength{\parskip}{0.4em}
\setlength{\parindent}{0pt}

\section{Introduzione}
I requisiti funzionali definiscono le funzioni che il sistema \textit{Trento Decide} deve offrire per supportare la partecipazione civica, la collaborazione tra cittadini e amministrazione comunale e la trasparenza del processo decisionale.  
Ogni requisito è formulato in modo chiaro e verificabile ed è identificato dal prefisso \textbf{RF}, seguito da un numero progressivo e, ove necessario, da sottosezioni tematiche.  

% ====================================================
% RF1
% ====================================================

\section{Autenticazione e gestione credenziali}

\subsection{Registrazione dei cittadini} \label{sec:registrazione}
L'utente che intende registrarsi come cittadino deve accedere inizialmente con SPID o CIE, il sistema richiede l'inserimento di email, password e nome utente (credenziali locali); inoltre l’utente può opzionalmente acconsentire a ricevere notifiche via email.  Al termine, il sistema invia all'utente una email di conferma.

\subsection{Registrazione di moderatori e associazioni}
Gli account dei moderatori e delle associazioni/comitati vengono creati dall’amministratore tramite l’interfaccia di gestione.
Il sistema invia ai destinatari le credenziali di accesso tramite email.

\subsection{Login} \label{sec:login}
Il sistema deve consentire il login tramite credenziali locali (email e password) oppure tramite SPID o CIE.

\subsection{Gestione credenziali utente}
L'utente deve poter:
\begin{itemize}
  \item visualizzare e aggiornare email, username e password;
  \item aggiornare la preferenza relativa alla ricezione delle notifiche via email;
   \item consultare lo storico di modifiche alle proprie credenziali;
  \item richiedere la cancellazione del proprio profilo;
\end{itemize}

% ====================================================
% RF2
% ====================================================

\section{Gestione proposte cittadine e sondaggi}

\subsection{Creazione proposta}
Il sistema deve consentire ai cittadini di creare nuove proposte in stato di \textit{bozza}, compilando un modulo composto dai seguenti campi obbligatori:
\begin{itemize}
    \item \textbf{Titolo} — testo breve che identifica la proposta;
    \item \textbf{Descrizione} — testo esteso che illustra il contenuto della proposta;
    \item \textbf{Luogo} — indicazione dell’area geografica interessata, selezionabile tramite indirizzo o mappa;
    \item \textbf{Categoria} — definizione \ref{sec:cat};
\end{itemize}

Inoltre il sistema deve salvare automaticamente, per ogni proposta, le seguenti informazioni:
\begin{itemize}
    \item \textbf{Autore} — nome utente del cittadino che ha creato la proposta;
    \item \textbf{Data} — timestamp di creazione generato dal sistema;
\end{itemize}

I valori e la presenza di ciascun campo possono variare in base alla categoria selezionata.  
Il sistema deve utilizzare per ogni categoria l’elenco dei campi obbligatori e facoltativi configurato dall’amministrazione comunale.

\subsection{Pubblicazione proposta}
Il sistema deve consentire al cittadino autore di pubblicare una proposta precedentemente salvata in stato di \textit{bozza}.  
La pubblicazione è possibile solo se tutti i campi obbligatori previsti per la categoria selezionata risultano compilati.  
Al momento della pubblicazione il sistema aggiorna lo stato della proposta a \textit{pubblicata}.

\subsection{Proposte collettive}
Il sistema deve consentire ad associazioni e comitati di presentare \textbf{proposte collettive} (def.~\ref{def:proposta-collettiva}).  
Il sistema deve etichettare tali proposte come “collettive” e applicare ad esse gli stessi processi di validazione e pubblicazione previsti per le proposte individuali.

\subsection{Sondaggi} \label{sec:sondaggi}
Il sistema deve consentire all’amministrazione di creare, pubblicare e gestire sondaggi tematici rivolti ai cittadini.  
Ogni sondaggio deve comprendere:  
(a) \textit{Titolo}, 
(b) \textit{Descrizione}, 
(c) \textit{Categoria}, 
(d) \textit{Periodo di apertura} (data di apertura e di chiusura),
(e) \textit{Domande} (e relative opzioni di risposta).  

Il sistema deve inoltre:
\begin{itemize}
	\item chiudere automaticamente i sondaggi alla data di scadenza;
	\item raccogliere in modo anonimo le risposte dei cittadini, rendendole disponibili all'amministrazione;
\end{itemize}

\subsection{Visualizzazione proposte}
Il sistema deve consentire al cittadino di:
\begin{itemize}
  	\item visualizzare l’elenco delle proprie proposte, distinguendo tra quelle in stato di \textit{bozza} e quelle pubblicate;
  	\item visualizzare le proposte pubblicate da altri utenti, applicando i criteri definiti in \ref{sec:sorting}.
	  \item visualizzare i sondaggi pubblicati dall'amministrazione.
\end{itemize}

\subsection{Stato e tracciabilità delle proposte} \label{sec:stato-tracciabilita}
Il sistema deve mostrare per ogni proposta lo stato corrente — \textit{bozza}, \textit{pubblicata}, \textit{in valutazione}, \textit{accettata}, \textit{rifiutata}, \textit{in attuazione}, \textit{completata} — e la cronologia pubblica delle transizioni di stato.

\subsection{Modifica collaborativa}
Il sistema deve consentire la modifica collaborativa delle proposte, come segue:

\subsubsection{Versionamento}
Ogni modifica a una proposta deve registrare autore, data/ora, descrizione e differenze rispetto alla versione precedente; tutte le versioni restano consultabili.
\subsubsection{Proposte di modifica da terzi}
Un utente diverso dal creatore può proporre una modifica; la proposta entra in uno stato di revisione non pubblica fino a decisione.
\subsubsection{Approvazione delle modifiche}
Il creatore della proposta può accettare o rifiutare una proposta di modifica; l’esito è tracciato.
\subsubsection{Ripristino}
Deve essere possibile ripristinare una versione precedente come versione principale.

\subsection{Endorsement e raccolta firme}
Il sistema deve consentire ai cittadini e alle associazioni registrate di esprimere un \textbf{endorsement} digitale (def.~\ref{def:endorsement}) sulle proposte pubblicate.  
Il sistema deve inoltre registrare e verificare le firme fisiche raccolte offline, integrandole nel conteggio del sostegno alla proposta.

% ====================================================
% RF3
% ====================================================

\section{Personalizzazione e preferenze}

\subsection{Preferiti} \label{sec:preferiti}
Il sistema deve consentire al cittadino di:
\begin{itemize}
	\item contrassegnare e rimuovere dai \textit{preferiti} proposte e sondaggi;
	\item visualizzare l’elenco dei propri elementi preferiti;
\end{itemize}

\subsection{Notifiche e avvisi}
Il sistema deve inviare notifiche automatiche per variazioni di stato o richieste di modifica (aggiornamenti relativi a elementi tra i preferiti).
Le notifiche vengono inviate solo se l’utente ha acconsentito alla ricezione di notifiche (\ref{sec:registrazione}).

\subsection{Cambio di lingua}
Il sistema deve consentire all’utente di modificare la lingua dell’interfaccia tramite un menu dedicato accessibile dall’area utente.  
La preferenza linguistica deve essere registrata nel profilo utente e mantenuta tra le sessioni di accesso.

% ====================================================
% RF4
% ====================================================

\section{Votazioni e ordinamento}

\subsection{Votazione}
Il sistema deve consentire agli utenti eleggibili al voto (cfr.~Definizioni) di esprimere un voto positivo o negativo su:
\begin{itemize}
	\item \textbf{Proposte}: voto modificabile fino allo stato di \textit{accettata} o \textit{rifiutata};
	\item \textbf{Sondaggi}: voto modificabile fino a chiusura dello stesso;
\end{itemize}
Ogni elettore può esprimere un solo voto.

\subsection{Ordinamento delle proposte}  \label{sec:sorting}
Il sistema deve consentire all’utente di ordinare l’elenco delle proposte pubblicate attraverso almeno le seguenti chiavi:
\begin{itemize}
  \item punteggio di rilevanza (valore numerico esposto);
  \item numero totale di voti;
  \item data di pubblicazione (più recente / meno recente);
  \item categoria.
\end{itemize}
L’utente deve poter invertire l’ordine (asc/desc) quando applicabile.

% ====================================================
% RF5
% ====================================================

\section{Moderazione e qualità dei contenuti}

\subsection{Moderazione automatica}
Il sistema deve analizzare automaticamente i contenuti generati dagli utenti (testi e materiali multimediali) per rilevare linguaggio inappropriato, spam o duplicati.  
In caso di rilevamento, il sistema deve segnalare l’elemento ai moderatori o sospenderne la pubblicazione in attesa di verifica.

\subsection{Intervento dei moderatori}
Il sistema deve includere un modulo di moderazione che consenta di gestire i contenuti segnalati o non conformi.  
I cittadini devono poter segnalare un contenuto.  
I moderatori devono poter sospendere o eliminare i contenuti segnalati.  
Ogni azione di moderazione deve essere registrata con identificativo utente, data e motivazione.

% ====================================================
% RF6
% ====================================================

\section{Policy Simulator e modelli statistici}

\subsection{Simulazione di scenari di policy}
Il sistema deve includere un modulo che consenta di calcolare indicatori di impatto economico, ambientale e sociale delle proposte utilizzando dataset configurabili.

\subsection{Analisi predittiva e statistica}
Il sistema deve consentire la generazione di previsioni sull’effetto delle proposte tramite modelli configurabili; gli indicatori prodotti devono essere quantitativi e misurabili (es. variazioni stimate di traffico, emissioni o costi).

\subsection{Visualizzazione interattiva delle simulazioni}
Il sistema deve visualizzare i risultati delle simulazioni tramite mappe tematiche e grafici comparativi.


% ====================================================
% RF7
% ====================================================

\section{Trasparenza e reportistica}

\subsection{Report votazioni} \label{sec:report-votazioni}
Il sistema deve consentire all’amministrazione di generare in formato CSV report riepilogativi sulle votazioni concluse.  Ogni report deve includere i seguenti indicatori: (a) numero totale di votanti; (b) distribuzione territoriale; (c) distribuzione per fasce d’età.  

\subsection{Report sui dati generali del sistema}  \label{sec:report-generali}
Il sistema deve fornire all’amministrazione una dashboard che mostri il numero di utenti attivi, le proposte per categoria, la distribuzione territoriale dei voti e i tassi di approvazione.  
I dati devono poter essere esportati in formato CSV.

\subsection{Open Data}
Il sistema deve consentire il download in locale dei dataset relativi ai report descritti in \ref{sec:report-generali} e \ref{sec:report-votazioni}.  
I dati devono essere resi disponibili in formato aperto (CSV) e comprendere esclusivamente informazioni anonimizzate.

\subsection{Trasparenza e accountability} \label{sec:trasparenza}
Il sistema deve consentire all’amministrazione comunale, al termine del processo di valutazione, di pubblicare per ogni proposta conclusa un riscontro ufficiale contenente l’esito (accettazione o rifiuto) e la relativa motivazione.  
Il riscontro deve essere visibile nella pagina pubblica della proposta, associato allo stato finale.


